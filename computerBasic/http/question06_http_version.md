# http各版本之间的差异

## 1. http/0.9版本

http/0.9是http协议最古老的一个版本，诞生于1991年

1. 只支持GET请求
2. 没有请求头的概念，只能够请求html文件



## 2. http/1.0版本

1.0版本在0.9的基础上增加了很多功能

1. 可以发送任意格式的数据，文字，图片，二进制文件等
2. 增加了POST和HEAD方法
3. 修改了请求报文和响应报文的格式，含有数据部分和头部信息
4. 增加了http缓存

**缺点**：

1. **TCP连接无法复用，每次请求都需要新建一个TCP连接，然后在请求完成之后，这个TCP连接就会断开**。所以每次请求都需要经历三次握手和四次挥手的阶段，使得网络利用率比较低
2. http/1.0版本中规定**前一个请求响应完成之后才能发起下一个请求，会造成比较严重的阻塞现象**



## 3. http/1.1版本

http/1.1版本改善了1.0版本中存在的问题，目前有很多的网站都是使用的1.1版本

1. 使用长连接：新增一个Connection字段，默认为keep-alive，表示这个TCP连接可以被其他请求复用
2. 管道机制：在同一个TCP连接中，客户端可以同时发送多个请求，而不是等第一个请求响应之后再发第二个请求。但是**响应返回的顺序和请求的顺序需要保持一致**（类似滑动窗口）
3. 缓存处理：增加了Cache-Control字段控制缓存
4. 增加了PUT OPTIONS DELETE TRACE CONNECT等请求方法



缺点：

1. **队头阻塞**：在**同一个TCP连接**中，所有的请求都是按照次序响应的，也就是说如果前一个请求没有响应完成就不会去响应后一个请求。如果前面响应的速度比较慢的话，后面的请求就只能一直等待，如此就造成了对头阻塞



## 4. http/2.0版本

http/2.0版本相对于1.1版本来说是一个巨大的提升

### 4.1* 二进制传输

在http1.x的版本中，是以文本为单位来进行传输的。而**在http2.0的版本中是以二进制帧为基本单位来传输的。每一个二进制帧中包含了数据以及帧的标识，标识这个帧属于哪一个request**。这也是多路复用的实现基础

### 4.2* 多路复用

在http1.x的版本中，**一个TCP连接同时只能发送或者响应一个请求**，为了解决效率的问题，就需要多建立几个TCP连接来并发多个请求。但是浏览器中同一个域名下能够建立的TCP连接数是有限的（chrome中大概是6个），所以在请求很多的时候会发生对头阻塞的情况。

在http2.0的版本中，提供了一个多路复用的功能：

1. **多个请求共用同一个TCP连接，基本上一个域名只需要一个TCP连接**。可以减少TCP连接创建的成本
2. **多个请求可以在这个TCP连接上并发，不管是发送还是响应**。这得益于上面所说的二进制传输，每个二进制帧都有一个自己的标识，所以多个请求的不同帧可以并发的发送出去，然后服务端根据帧中的身份标识来重组每一个request。

### 4.3 Header压缩

不出意外，每个请求的请求头中都会带有一个Cookie字段，但是Cookie字段的内容可能都是相同的，所以每次都需要重复传输几百到几千个字节。

在http2.0中，**使用HPACK算法对请求头进行压缩，减少请求的大小**。并且在两端维护索引表，用于记录出现过的header，后面传输的过程中就可以只传输已经被记录的键名，然后对端会去索引表中获取键值

### 4.4 服务端PUSH

**HTTP/2.0 允许服务器未经请求，主动向客户端发送资源，这叫做服务器推送。**

当我们对支持 HTTP2.0 的服务器请求数据的时候，服务器会顺便把一些客户端需要的资源一起推送到客户端，免得客户端再次创建连接发送请求到服务器端获取。这种方式非常合适加载静态资源

比如请求一个html页面时，服务端会把html页面中包含的CSS、JS资源主动推给服务端，减少请求等待。

**服务器端推送的这些资源其实存在客户端的某处地方，客户端直接从本地加载这些资源就可以了**，不用走网络，速度自然是快很多的



## 参考文章

1. [计算机网络面试（12）HTTP 各版本差异](https://lixiaoyu.cc/2018/09/04/computer-network-12-http-version-differences/)
2. [（建议精读）HTTP灵魂之问，巩固你的 HTTP 知识体系](https://juejin.cn/post/6844904100035821575#heading-90)

