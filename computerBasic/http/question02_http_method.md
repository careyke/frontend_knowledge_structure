# http请求的方法对比

http的各个版本中提供了丰富的请求方法来适应各种场景的需求

http1.0中有三种请求方法：GET POST HEAD

http1.1中增加了5中请求方法：PUT DELETE OPTIONS TRACE CONNECT

还有一种方法：PATCH

## 1. 方法对比的维度

### 1.1 幂等

**在同一个系统中，使用同样的条件，发送一次或者多次请求对于服务器资源的影响是一致的。这种请求就是幂等的请求**

### 1.2 安全性

请求是否会影响服务端资源的状态，如果有影响则是不安全的，否则就是安全的

### 1.3 是否可以缓存

请求的响应体是否可以使用缓存，包括强缓存和协商缓存

### 1.4 是否有请求体

### 1.5 是否有响应体



## 2. 对比各个请求方法

### 2.1 GET方法

GET请求用于获取服务端的资源，应该**只用读取数据**。

1. GET请求是幂等的，因为只是读取数据
2. GET请求是安全的
3. GET请求是可以缓存的
4. GET请求没有请求体，其请求的参数会拼接在url后面
5. GET请求有响应体



### 2.2 POST方法

POST方法会向服务端提交资源，往往会在服务端**新增或者修改**某些资源。

1. POST请求不是幂等的，多次调用可能会带啦其他影响
2. POST请求是不安全的，会影响服务器资源的状态
3. POST请求的资源是可以缓存的
4. POST请求有请求体
5. 有响应体



### 2.3 HEAD方法

HEAD请求和GET请求是一样的，都是请求指定的资源。但是不同的是，**HEAD请求的响应报文中，只有响应头不包含响应体**。

使用HEAD请求可以先返回资源的一些信息，比如资源的大小，有效性等等，可以防止请求无效的资源带来的额外消耗。

1. 幂等
2. 安全的请求
3. 可以缓存
4. 没有请求体
5. 没有响应体



### 2.4 PUT方法

PUT是指使用请求中的数据在指定的位置**替换目标资源**。这个方法和POST有些类似，但是不同的是：**PUT方法是幂等的**

1. 幂等
2. 不安全的请求
3. 不可以缓存
4. 有请求体
5. 没有响应体，即无后续副作用操作



### 2.5 DELETE方法

DELETE请求用来删除指定的资源

1. 幂等
2. 不安全的请求
3. 不可以缓存，不一定有响应体
4. 可以有请求体
5. 可以有响应体



### 2.6 OPTIONS方法

**OPTIONS请求用来获取当前资源所支持的所有http请求方法**，和HEAD请求类似，响应报文中没有响应体

1. 幂等
2. 安全的请求
3. 不可以缓存
4. 没有请求体
5. 没有响应体

**OPTIONS方法的使用场景**

1. 用来检测服务器所支持的请求方法。响应报文中有一个Allow字段，用来存放所支持的方法

   ```js
   curl -X OPTIONS http://example.org -i
   
   HTTP/1.1 200 OK
   Allow: OPTIONS, GET, HEAD, POST
   Cache-Control: max-age=604800
   Date: Thu, 13 Oct 2016 11:45:00 GMT
   Expires: Thu, 20 Oct 2016 11:45:00 GMT
   Server: EOS (lax004/2813)
   x-ec-custom-error: 1
   Content-Length: 0
   ```

2. **用来做CORS中的预请求。用来检测实际的请求能否被服务器所接受**



### 2.7 CONNECT方法

CONNECT方法可以**开启一个客户端与所请求资源之间的双向沟通的通道**。常用于SSL加密服务器的链接与非加密的HTTP代理服务器的通信

1. 不幂等
2. 不安全
3. 不可以缓存
4. 没有请求体
5. 有响应体



### 2.8 TRACE方法

TRACE请求服务器之后，服务器会将接收到的请求报文原样返回回去。该方法常常用来http请求的测试或者诊断

1. 幂等
2. 不安全
3. 不可以缓存
4. 没有请求体
5. 没有响应体



### 2.9 PATCH方法

PATCH方法也是用来修改服务器资源的方法，这一点和PUT方法有点类似。

**和PUT放在之间的不同**：

1. PATCH方法是对资源的部分修改，而PUT是整体覆盖
2. 当资源不存在的时候，PATCH方法会创建一个新的资源，而PUT方法只会对已存在的资源做更新



PATCH方法的特点：

1. 不是幂等的，但是PUT是幂等的
2. 不是安全的
3. 不可以缓存
4. 有请求体
5. 没有响应体



## 3. 请求方法之间的比较

### 3.1 GET和POST方法之间的比较

1. GET请求是没有请求体的，其传到后端的数据会拼接在url后面，信息直接暴露不安全；POST请求是有请求体的，相对于GET请求会比较安全。但是在抓包的时候都是一样的
2. GET请求是把数据拼接在url后面的，而浏览器对于url的长度是有限制的，大约是4KB，所以**GET请求传递的数据大小是有限的；POST请求传递的数据理论上是没有大小限制的**，但是实际上服务器也会做一些限制
3. GET请求是幂等请求；POST请求不是幂等请求



### 3.2 POST VS PUT VS PATCH

这个三个方法都是用来修改服务器资源的方法，但是在使用场景中略有不同

1. POST方法会创建新的资源或者修改资源；PUT和PATCH方法用于更新资源
2. PUT和PATCH之间的区别
   - PUT是覆盖式的整体更新，PATCH是部分更新
   - PUT只能对已存在的资源更新，对于不存在的资源不操作；PATCH在资源不存在的时候，会创建这个资源
3. POST和PATCH不是幂等请求，PUT是幂等请求

